clear; clc;
V = [525.009
523.803
522.521
521.179
519.788
518.356
516.893
515.408
513.912
512.415
510.926
509.456
508.014
506.609
505.251
503.949
502.709
501.540
500.449
499.442
498.525
497.702
496.978
496.356
495.839
495.428
495.124
494.927
494.838
494.853
494.972
495.192
495.509
495.919
496.417
496.999
497.658
498.390
499.187
500.043
500.952
501.906
502.898
503.922
504.970
506.035
507.111
508.191
509.269
510.338
511.393
512.429
513.441
514.423
515.373
516.286
517.159
517.990
518.776
519.516
520.208
520.852
521.448
521.996
522.495
522.948
523.356
523.719
524.041
524.324
524.570
524.781
524.961
525.112
525.238
525.341
525.426
525.494
525.550
525.596
525.635
525.669
525.702
525.736
525.773
525.816
525.865
525.923
525.991
526.071
526.163
526.267
526.385
526.516
526.660
526.818
526.988
527.171
527.365
527.570
527.784
528.006
528.236
528.471
528.710
528.952
529.196
529.439
529.681
529.920
530.154
530.383
530.605
530.819
531.023
531.217
531.400
531.571
531.730
531.875
532.006
532.123
532.225
532.313
532.387
532.445
532.489
532.518
532.534
532.535
532.522
532.497
532.458
532.407
532.343
532.268
532.182
532.085
531.978
531.860
531.733
531.596
531.450
531.295
531.132
530.960
530.779
530.590
530.393
530.188
529.974
529.753
529.523
529.286
529.040
528.786
528.524
528.255
527.977
527.692
527.400
527.101
526.795
526.482
526.164
525.841
525.513
525.181
524.846
524.509
524.171
523.832
523.495
523.160
522.828
522.502
522.181
521.869
521.565
521.272
520.991
520.724
520.472
520.237
520.019
519.822
519.645
519.490
519.358
519.251
519.169
519.113
519.085
519.084
519.111
519.167
519.251
519.364
519.505
519.675
519.873
520.097
520.348
520.625
520.926
521.251
521.597
521.963
522.349
522.752
523.170
523.601
524.044
524.497
524.957
525.423
525.893
526.363
526.833
527.301
527.763
528.219
528.667
529.105
529.531
529.943
530.341
530.722
531.087
531.433
531.759
532.066
532.352
532.617
532.861
533.083
533.283
533.461
533.619
533.755
533.871
533.967
534.044
534.102
534.143
534.167
534.175
534.168
534.148
534.116
534.072
534.017
533.953
533.881
533.801
533.715
533.624
533.528
533.428
533.324
533.218
533.110
533.001
532.889
532.777
532.663
532.548
532.432
532.315
532.196
532.075
531.951
531.825
531.695
531.560
531.422
531.277
531.126
530.969
530.803
530.630
530.447
530.254
530.050
529.835
529.608
529.369
529.117
528.852
528.573
528.281
527.975
527.655
527.321
526.974
526.613
526.240
525.855
525.457
525.049
524.631
524.203
523.767
523.324
522.875
522.422
521.965
521.505
521.046
520.586
520.129
519.676
519.228
518.786
518.352
517.928
517.514
517.113
516.725
516.352
515.995
515.655
515.333
515.030
514.747
514.484
514.243
514.024
513.827
513.652
513.501
513.373
513.268
513.187
513.128
513.093
513.081
513.090
513.122
513.175
513.250
513.344
513.458
513.591
513.743
513.912
514.097
514.299
514.515
514.747
514.991
515.248
515.518
515.798
516.089
516.390
516.700
517.018
517.344
517.678
518.018
518.364
518.716
519.073
519.435
519.801
520.171
520.545
520.922
521.302
521.685
522.071
522.458
522.847
523.238
523.630
524.023
524.417
524.811
525.205
525.598
525.991
526.382
526.771
527.157
527.541
527.921
528.297
528.669
529.034
529.394
529.746
530.091
530.427
530.754
531.070
531.376
531.669
531.950
532.218
532.470
532.708
532.930
533.135
533.322
533.492
533.642
533.773
533.885
533.976
534.046
534.095
534.123
534.130
534.115
534.079
534.021
533.942
533.842
533.722
533.581
533.420
533.241
533.043
532.827
532.595
532.347
532.084
531.807
531.517
531.215
530.903
530.581
530.251
529.914
529.571
529.223
528.873
528.520
528.166
527.812
527.460
527.110
526.764
526.422
526.086
525.756
525.434
525.119
524.812
524.515
524.228
523.951
523.685
523.429
523.185
522.952
522.730
522.520
522.321
522.134
521.957
521.792
521.637
521.493
521.359
521.235
521.119
521.013
520.915
520.826
520.744
520.669
520.601
520.539
520.483
520.433
520.389
520.349
520.314
520.284
520.258
520.236
520.218
520.205
520.196
520.190
520.189
520.193
520.201
520.214
520.232
520.256
520.285
520.320
520.362
520.410
520.466
520.530
520.601
520.681
520.770
520.868
520.975
521.092
521.220
521.358
521.507
521.666
521.836
522.018
522.210
522.413
522.627
522.852
523.087
523.332
523.587
523.851
524.123
524.404
524.692
524.987
525.287
525.593
525.903
526.216
526.532
526.849
527.166
527.482
527.797
528.108
528.416
528.719
529.015
529.304
529.584
529.856
530.116
530.366
530.603
530.827
531.037
531.233
531.413
531.577
531.724
531.854
531.967
532.061
532.138
532.196
532.236
532.257
532.260
532.245
532.212
532.160
532.092
532.006
531.903
531.785
531.650
531.501
531.338
531.161
530.972
530.771
530.558
530.335
530.103
529.862
529.613
529.357
529.096
528.829
528.558
528.283
528.006
527.726
527.446
527.164
526.883
526.603
526.325
526.048
525.774
525.502
525.235
524.971
524.711
524.456
524.206
523.961
523.721
523.488
523.259
523.037
522.821
522.611
522.407
522.210
522.019
521.835
521.657
521.485
521.320
521.162
521.010
520.865
520.727
520.595
520.471
520.353
520.243
520.139
520.043
519.954
519.873
519.799
519.733
519.675
519.626
519.584
519.552
519.528
519.512
519.506
519.509
519.522
519.544
519.576
519.618
519.670
519.731
519.803
519.885
519.978
520.080
520.193
520.315
520.448
520.590
520.742
520.903
521.073
521.252
521.439
521.634
521.837
522.046
522.262
522.484
522.712
522.944
523.180
523.420
523.663
523.908
524.154
524.401
524.647
524.893
525.138
525.380
525.619
525.854
526.085
526.311
526.530
526.744
526.950
527.149
527.340
527.522
527.695
527.858
528.012
528.155
528.288
528.410
528.521
528.621
528.710
528.788
528.855
528.911
528.955
528.989
529.013
529.026
529.028
529.021
529.005
528.980
528.945
528.903
528.852
528.795
528.730
528.659
528.582
528.499
528.411
528.319
528.222
528.122
528.019
527.913
527.804
527.694
527.582
527.468
527.354
527.239
527.123
527.007
526.891
526.775
526.660
526.545
526.430
526.316
526.203
526.090
525.978
525.866
525.756
525.645
525.536
525.426
525.318
525.209
525.101
524.993
524.885
524.777
524.669
524.561
524.453
524.345
524.237
524.129
524.021
523.913
523.806
523.698
523.592
523.485
523.380
523.276
523.172
523.071
522.971
522.873
522.777
522.684
522.595
522.508
522.425
522.346
522.272
522.202
522.138
522.079
522.025
521.978
521.938
521.904
521.877
521.857
521.845
521.840
521.844
521.855
521.875
521.903
521.939
521.983
522.036
522.096
522.165
522.242
522.326
522.417
522.516
522.622
522.734
522.853
522.977
523.106
523.241
523.380
523.522
523.668
523.817
523.969
524.122
524.276
524.431
524.585
524.740
524.893
525.045
525.194
525.341
525.485
525.626
525.762
525.894
526.021
526.143
526.259
526.369
526.474
526.572
526.664
526.750
526.828
526.900
526.966
527.024
527.076
527.122
527.160
527.193
527.220
527.240
527.255
527.265
527.269
527.269
527.264
527.255
527.242
527.226
527.206
527.184
527.159
527.132
527.104
527.074
527.043
527.011
526.978
526.946
526.913
526.881
526.849
526.818
526.788
526.759
526.731
526.705
526.679
526.656
526.633
526.612
526.593
526.575
526.558
526.542
526.528
526.515
526.503
526.491
526.481
526.471
526.461
526.452
526.443
526.433
526.424
526.414
526.404
526.393
526.382
526.370
526.357
526.343
526.328
526.312
526.294
526.276
526.256
526.236
526.214
526.192
526.168
526.144
526.119
526.093
526.067
526.040
526.014
525.987
525.961
525.935
525.909
525.885
525.861
525.838
525.817
525.798
525.780
525.764
525.750
525.738
525.729
525.722
525.718
525.716
525.717
525.721
525.727
525.737
525.749
525.764
525.782
525.802
525.825
525.850
525.877
525.907
525.938
525.971
526.005
526.040
526.077
526.114
526.151
526.189
526.226
526.262
526.298
526.333
526.366
526.397
526.426
526.453
526.477
526.498
526.516
526.530
526.540
526.547
526.549
526.547
526.541
526.530
526.514
526.493
526.467
526.437
526.401
526.360
526.315
526.264
526.209
526.149
526.085
526.016
525.944
525.867
525.786
525.702
525.615
525.525
525.432
525.336
525.239
525.140
525.040
524.939
524.837
524.734
524.632
524.530
524.429
524.329
524.230
524.133
524.038
523.946
523.856
523.769
523.685
523.605
523.529
523.457
523.389
523.325
523.266
523.212
523.163
523.119
523.081
523.047
523.019
522.997
522.980
522.969
522.963
522.963
522.969
522.980
522.997
523.020
523.048
523.081
523.120
523.164
523.214
523.268
523.327
523.392
523.460
523.534
523.612
523.694
523.781
523.871
523.965
524.063
524.165
524.270
524.377
524.488
524.602
524.718
524.837
524.957
525.080
525.205
525.331
525.458
525.587
525.717
525.847
525.978
526.109
526.240
526.371
526.502
526.632
526.761
526.889
527.016
527.141
527.265
527.386
527.505
527.622
527.736
527.848
527.956
528.061
528.162
528.260
528.354
528.444
528.529
528.611
528.687
528.759
528.826
528.889
528.946
528.998
529.044
529.086
529.122
529.153
529.178
529.197
529.212
529.220
529.224
529.222
529.214
529.201
529.183
529.160
529.131
529.098
529.060
529.017
528.969
528.917
528.860
528.799
528.734
528.666
528.593
528.517
528.437
528.354
528.268
528.179
528.087
527.993
527.895
527.796
527.694
527.591
527.485
527.378
527.269
527.158
527.046
526.933
526.818
526.702
526.585
526.468
526.349
526.230
526.110
525.990
525.869
525.748
525.627
525.505
525.383
525.262
525.140
525.019
524.897
524.777
524.657
524.537
524.418
524.301
524.184
524.069
523.955
523.842
523.732
523.623
523.517
523.413
523.312
523.214
523.119
523.027
522.939
522.855
522.775
522.700
522.629
522.563
522.502
522.447
522.398
522.355
522.318
522.287
522.264
522.247
522.237
522.235
522.240
522.253
522.274
522.302
522.339
522.383
522.436
522.496
522.565
522.642
522.726
522.818
522.918
523.026
523.141
523.262
523.391
523.526
523.668
523.815
523.968
524.126
524.288
524.455
524.626
524.800
524.978
525.157
525.339
525.521
525.705
525.889
526.073
526.256
526.438
526.618
526.795
526.970
527.142
527.309
527.473
527.631
527.785
527.933
528.075
528.211
528.340
528.462
528.578
528.685
528.785
528.878
528.962
529.038
529.107
529.167
529.219
529.262
529.298
529.326
529.345
529.357
529.362
529.359
529.348
529.331
529.307
529.277
529.240
529.198
529.150
529.097
529.039
528.976
528.909
528.839
528.764
528.687
528.606
528.523
528.438
528.351
528.262
528.172
528.081
527.989
527.896
527.803
527.709
527.616
527.523
527.430
527.337
527.245
527.153
527.062
526.972
526.882
526.794
526.706
526.618
526.532
526.446
526.361
526.276
526.192
526.109
526.026
525.943
525.861
525.779
525.697
525.615
525.533
525.452
525.370
525.288
525.207
525.125
525.043
524.961
524.880
524.798
524.716
524.635
524.554
524.473
524.393
524.314
524.236
524.158
524.082
524.007
523.933
523.862
523.792
523.725
523.660
523.598
523.538
523.482
523.429
523.380
523.335
523.294
523.257
523.225
523.197
523.174
523.156
523.144
523.137
523.135
523.139
523.149
523.165
523.186
523.213
523.246
523.285
523.330
523.380
523.436
523.498
523.565
523.637
523.714
523.796
523.883
523.974
524.069
524.168
524.270
524.376
524.485
524.596
524.710
524.825
524.942
525.061
525.180
525.299
525.418
525.538
525.656
525.773
525.889
526.004
526.116
526.225
526.332
526.436
526.537
526.633
526.726
526.815
526.900
526.980
527.055
527.126
527.191
527.251
527.306
527.356
527.400
527.439
527.472
527.500
527.523
527.540
527.553
527.559
527.561
527.558
527.550
527.538
527.521
527.499
527.474
527.444
527.411
527.374
527.334
527.291
527.245
527.197
527.146
527.093
527.038
526.982
526.924
526.865
526.805
526.745
526.684
526.622
526.561
526.499
526.438
526.377
526.317
526.258
526.200
526.143
526.087
526.032
525.979
525.927
525.876
525.828
525.781
525.735
525.692
525.650
525.610
525.572
525.536
525.501
525.468
525.437
525.408
525.380
525.354
525.329
525.306
525.284
525.264
525.245
525.227
525.210
525.194
525.179
525.165
525.152
525.139
525.128
525.116
525.106
525.095
525.085
525.076
525.066
525.057
525.048
525.039
525.030
525.021
525.012
525.003
524.994
524.985
524.976
524.967
524.958
524.949
524.940
524.931
524.922
524.913
524.904
524.895
524.887
524.879
524.871
524.864
524.856
524.850
524.844
524.839
524.834
524.830
524.827
524.825
524.823
524.823
524.824
524.825
524.828
524.833
524.838
524.845
524.853
524.862
524.873
524.885
524.898
524.913
524.929
524.946
524.965
524.985
525.006
525.028
525.051
525.076
525.101
525.128
525.155
525.182
525.211
525.240
525.269
525.299
525.328
525.358
525.388
525.417
525.446
525.475
525.503
525.530
525.557
525.582
525.606
525.629
525.650
525.670
525.689
525.706
525.720
525.733
525.744
525.754
525.760
525.765
525.768
525.768
525.767
525.763
525.757
525.748
525.738
525.725
525.711
525.694
525.676
525.656
525.635
525.611
525.587
525.561
525.534
525.506
525.478
525.448
525.419
525.389
525.358
525.328
525.299
525.270
525.241
525.213
525.186
525.161
525.137
525.114
525.093
525.074
525.057
525.042
525.029
525.018
525.010
525.004
525.001
525.001
525.003
525.007
525.014
525.024
525.037
525.052
525.069
525.089
525.111
525.136
525.162
525.190
525.221
525.252
525.286
525.320
525.356
525.392
525.429
525.467
525.505
525.543
525.581
525.618
525.655
525.691
525.726
525.759
525.791
525.822
525.850
525.877
525.901
525.923
525.943
525.959
525.973
525.984
525.992
525.998
525.999
525.998
525.994
525.986
525.976
525.962
525.945
525.924
525.901
525.875
525.847
525.815
525.781
525.745
525.706
525.665
525.622
525.578
525.532
525.485
525.436
525.387
525.336
525.285
525.234
525.183
525.132
525.081
525.030
524.981
524.932
524.884
524.837
524.791
524.747
524.705
524.664
524.625
524.588
524.553
524.520
524.490
524.461
524.435
524.411
524.389
524.369
524.352
524.337
524.323
524.312
524.303
524.296
524.291
524.288
524.286
524.286
524.287
524.289
524.293
524.298
524.304
524.311
524.318
524.327
524.335
524.345
524.354
524.364
524.374
524.384
524.394
524.404
524.414
524.423
524.433
524.442
524.451
524.459
524.468
524.476
524.483
524.491
524.498
524.505
524.512
524.519
524.526
524.533
524.540
524.547
524.555
524.563
524.572
524.581
524.591
524.601
524.613
524.625
524.639
524.654
524.670
524.687
524.705
524.725
524.747
524.770
524.794
524.820
524.848
524.877
524.908
524.940
524.974
525.009
525.046
525.084
525.124
525.164
525.206
525.249
525.293
525.338
525.383
525.429
525.475
525.521
525.568
525.614
525.661
525.706
525.751
525.796
525.839
525.881
525.922
525.962
526
526.036
526.069
526.101
526.131
526.158
526.182
526.204
526.223
526.239
526.252
526.262
526.269
526.273
526.273
526.270
526.264
526.254
526.241
526.224
526.205
526.182
526.155
526.126
526.094
526.058
526.020
525.979
525.935
525.889
525.840
525.789
525.736
525.681
525.625
525.566
525.507
525.446
525.384
525.321
525.257
525.193
525.129
525.064
525
524.936
524.872
524.809
524.747
524.685
524.625
524.566
524.508
524.452
524.397
524.344
524.293
524.244
524.198
524.153
524.111
524.071
524.033
523.998
523.965
523.935
523.907
523.882
523.859
523.840
523.822
523.807
523.795
523.785
523.778
523.773
523.770
523.770
523.772
523.776
523.782
523.790
523.800
523.812
523.826
523.842
523.859
523.878
523.898
523.919
523.942
523.966
523.991
524.017
524.044
524.072
524.101
524.130
524.160
524.191
524.222
524.254
524.286
524.318
524.351
524.384
524.417
524.450
524.483
524.517
524.550
524.583
524.617
524.650
524.683
524.717
524.750
524.783
524.816
524.849
524.881
524.914
524.946
524.978
525.010
525.042
525.074
525.106
525.137
525.168
525.199
525.230
525.260
525.291
525.321
525.350
525.380
525.409
525.437
525.466
525.494
525.521
525.548
525.574
525.600
525.625
525.650
525.674
525.697
525.719
525.740
525.760
525.779
525.797
525.814
525.830
525.845
525.858
525.869
525.879
525.888
525.895
525.900
525.904
525.906
525.906
525.904
525.900
525.894
525.886
525.877
525.865
525.851
525.835
525.817
525.796
525.774
525.750
525.723
525.695
525.665
525.632
525.598
525.562
525.524
525.485
525.444
525.401
525.357
525.312
525.265
525.217
525.169
525.119
525.069
525.018
524.966
524.915
524.863
524.811
524.759
524.708
524.657
524.606
524.556
524.507
524.459
524.412
524.367
524.322
524.280
524.239
524.199
524.162
524.126
524.093
524.062
524.033
524.007
523.982
523.961
523.942
523.925
523.911
523.899
523.890
523.884
523.881
523.879
523.881
523.885
523.891
523.900
523.911
523.924
523.940
523.958
523.977
523.999
524.022
524.047
524.074
524.102
524.131
524.162
524.194
524.226
524.260
524.294
524.329
524.364
524.399
524.435
524.471];

num_sample = 2000;
sum = 0;
for k = 1:num_sample
    sum = sum + V(k)^2;
end
V_rms = sqrt(sum/num_sample);
V = V - V_rms;


stop_time = 20;
fs = num_sample/stop_time;
dt = 1/fs;
t = (0:dt:stop_time-dt)';
f = 0:fs/num_sample:fs-fs/num_sample;

X = abs(fftshift(fft(V)));

figure;
subplot(2,1,1);
pspectrum(V,fs);
xlabel('Time(sec)');
ylabel('Magnitude');
title('Frequency Spectrum');

subplot(2,1,2);
plot(f,X);
xlabel('Frequency(Hz)');
ylabel('Magnitude');
ylabel('Magnitude');
title('Frequency Analysis');
